defaultNamespace: cattle-system
dependsOn:
  - name: vaclab-2-fleet-cert-issuers
helm:
  repo: https://releases.rancher.com/server-charts/stable
  chart: rancher
  version: 2.13.1
  releaseName: rancher
  values:
    hostname: rancher.vaclab.diarra.tech
    bootstrapPassword: ""
    replicas: 1
    
    # Cluster branding
    extraEnv:
      - name: CATTLE_UI_BRAND
        value: "vaclab"
      - name: CATTLE_CLUSTER_NAME
        value: "vaclab"
      - name: CATTLE_UI_PL
        value: "vaclab"
      - name: CATTLE_UI_LOGO_LIGHT
        value: "https://raw.githubusercontent.com/vacp2p/vaclab-2/feat/add_lab_components/extras/vac-logo-light-no-bg.png"
      - name: CATTLE_UI_LOGO_DARK
        value: "https://raw.githubusercontent.com/vacp2p/vaclab-2/feat/add_lab_components/extras/vac-logo-light-no-bg.png"
    
    ingress:
      enabled: true
      tls:
        source: letsEncrypt
      ingressClassName: traefik
    
    letsEncrypt:
      email: mamoutou@status.im
      ingress:
        class: traefik
      environment: staging
    
    # Use existing cert-manager installation
    certmanager:
      install: false
diff:
  comparePatches:
  - apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    operations:
    - {"op": "remove", "path": "/metadata/annotations"}
    - {"op": "remove", "path": "/metadata/labels"}
  - apiVersion: apps/v1
    kind: Deployment
    operations:
    - {"op": "remove", "path": "/metadata/annotations"}
    - {"op": "remove", "path": "/metadata/labels"}
  - apiVersion: networking.k8s.io/v1
    kind: Ingress
    operations:
    - {"op": "remove", "path": "/metadata/annotations"}
    - {"op": "remove", "path": "/metadata/labels"}
  - apiVersion: cert-manager.io/v1
    kind: Issuer
    operations:
    - {"op": "remove", "path": "/metadata/annotations"}
    - {"op": "remove", "path": "/metadata/labels"}
